library(usethis)
use_git_config(user.name = "Jane Doe", user.email = "jane@example.org")
usethis::create_github_token()
#gitcreds::gitcreds_set()
#usethis::create_from_github("https://github.com/mkashyap95/PSTAT-231.git",
#destdir = "C:/Users/kashyap/Desktop")
git clone https://github.com/mkashyap95/PSTAT-231.git
setwd("C:/Users/kashyap/Desktop/Fall 2022/PSTAT-231/HW2")
read.csv("abalone.data")
df <- read.csv("abalone.data")
View(df)
desc <- read.csv("abalone.names")
View(desc)
#packages
library(tinymodels)
install.packages("tinymodels")
#packages
library(tinymodels)
install.packages("tidymodels")
#packages
library(tidymodels)
library(tidyverse)
#renaming column names
colnames(df) <- c('sex','length','diameter','ht','whole_wt','shucked_wt','viscera_wt','shell_wt','rings')
knitr::opts_chunk$set(echo = TRUE)
#packages
library(tidymodels)
library(tidyverse)
#data
df <- read.csv("abalone.data")
#renaming column names
colnames(df) <- c('sex','length','diameter','ht','whole_wt','shucked_wt','viscera_wt','shell
_wt','rings')
#creating age = no. of rings + 1.5
df$age <- df$rings + 1.5
head(df)
#distribution of age
df %>%
ggplot(aes(x=age)) +
geom_histogram(bins = 10) +
theme_classic()
#distribution of age
df %>%
ggplot(aes(x=age)) +
geom_histogram() +
theme_classic()
mean(df$age)
#distribution of age
df %>%
ggplot(aes(x=age)) +
geom_histogram() +
theme_classic()
?initial_split
set.seed(1995)
#splitting data
df_split <- initial_split(df, prop = 0.80, strata = age)
abalone_train <- training(df_split)
abalone_test <- testing(df_split)
View(df_split)
#creating recipe using training data
simple_abalone_recipe <- recipe(age ~ ., data = abalone_train)
simple_abalone_recipe
?step_dummy
View(df)
is.factor(df$sex)
?all_nominal_predictors
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ ., data = abalone_train) %>%
step_dummy(all_nominal_predictors())
abalone_recipe
View(abalone_recipe)
View(simple_abalone_recipe)
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ . + type*shucked_wt + length*diameter + shucked_wt*shell_wt,
data = abalone_train) %>%
step_dummy(all_nominal_predictors())
?step_interact
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ ., data = abalone_train) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms = ~ type:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
abalone_recipe
View(abalone_recipe)
lm_model <- linear_reg() %>%
set_engine("lm")
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe(abalone_recipe)
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe()
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe(abalone_recipe)
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
#creating recipe using training data
simple_abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt +
shucked_wt + viscera_wt + shell_wt,
data = abalone_train)
#renaming column names
colnames(df) <- c('sex','length','diameter','ht','whole_wt','shucked_wt','viscera_wt',
'shell_wt','rings')
knitr::opts_chunk$set(echo = TRUE)
#packages
library(tidymodels)
library(tidyverse)
#data
df <- read.csv("abalone.data")
#renaming column names
colnames(df) <- c('sex','length','diameter','ht','whole_wt','shucked_wt','viscera_wt',
'shell_wt','rings')
#creating age = no. of rings + 1.5
df$age <- df$rings + 1.5
head(df)
mean(df$age)
#distribution of age
df %>%
ggplot(aes(x=age)) +
geom_histogram() +
theme_classic()
set.seed(1995)
#splitting data
df_split <- initial_split(df, prop = 0.80, strata = age)
abalone_train <- training(df_split)
abalone_test <- testing(df_split)
#creating recipe using training data
simple_abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt +
shucked_wt + viscera_wt + shell_wt,
data = abalone_train)
simple_abalone_recipe
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms = ~ type:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
abalone_recipe
#creating and storing linear regression object
lm_model <- linear_reg() %>%
set_engine("lm")
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe(abalone_recipe)
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms = ~ sex:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
#creating and storing linear regression object
lm_model <- linear_reg() %>%
set_engine("lm")
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe(abalone_recipe)
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
step_interact(terms = ~ sex:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
abalone_recipe
#creating and storing linear regression object
lm_model <- linear_reg() %>%
set_engine("lm")
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe(abalone_recipe)
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt + sex:shucked_wt,
data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
#  step_interact(terms = ~ sex:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
step_interact(terms = ~ sex:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt + sex*shucked_wt, data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
step_interact(terms = ~ sex:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
step_interact(terms = ~ sex:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
abalone_recipe
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe(abalone_recipe)
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
step_interact(terms = ~ sex_F:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
abalone_recipe
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe(abalone_recipe)
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
View(lm_fit)
summary(lm_fit)
lm_fit
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
step_interact(terms = sex:shucked_wt) %>%
step_interact(terms = length:diameter) %>%
step_interact(terms = shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
step_interact(terms = ~ sex_F:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
step_interact(terms = ~ sex_M:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
lm_fit
lm_fit %>%
extract_fit_parsnip() %>%
tidy()
#training RMSE
abalone_train_res <- predict(lm_fit, new_data = abalone_train %>% select(-price))
#training RMSE
abalone_train_res <- predict(lm_fit, new_data = abalone_train %>% select(-age))
abalone_train_res %>%
head()
#attaching column of actual observed age
abalone_train_res <- bind_cols(abalone_train_res, abalone_train %>% select(age))
abalone_train_res %>%
head()
#plotting predicted vs. observed
abalone_train_res %>%
ggplot(aes(x=.pred, y=age)) +
geom_point(alpha = 0.2) +
geom_abline(lty=2) +
theme_classic() +
coord_obs_pred()
#plotting predicted vs. observed
abalone_train_res %>%
ggplot(aes(x=.pred, y=jitter(age))) +
geom_point(alpha = 0.2) +
geom_abline(lty=2) +
theme_classic() +
coord_obs_pred()
?yardstick
knitr::opts_chunk$set(echo = TRUE)
#packages
library(tidymodels)
library(tidyverse)
#data
df <- read.csv("abalone.data")
#renaming column names
colnames(df) <- c('sex','length','diameter','ht','whole_wt','shucked_wt','viscera_wt',
'shell_wt','rings')
#creating age = no. of rings + 1.5
df$age <- df$rings + 1.5
head(df)
mean(df$age)
#distribution of age
df %>%
ggplot(aes(x=age)) +
geom_histogram() +
theme_classic()
set.seed(1995)
#splitting data
df_split <- initial_split(df, prop = 0.80, strata = age)
abalone_train <- training(df_split)
abalone_test <- testing(df_split)
#creating recipe using training data
simple_abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt +
shucked_wt + viscera_wt + shell_wt,
data = abalone_train)
simple_abalone_recipe
#dummy coding categorical predictors
abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt + shucked_wt +
viscera_wt + shell_wt, data = abalone_train) %>%
step_dummy_multi_choice(all_nominal_predictors()) %>%
step_interact(terms = ~ sex_M:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
abalone_recipe
#creating and storing linear regression object
lm_model <- linear_reg() %>%
set_engine("lm")
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe(abalone_recipe)
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
lm_fit %>%
extract_fit_parsnip() %>%
tidy()
#training RMSE
abalone_train_res <- predict(lm_fit, new_data = abalone_train %>% select(-age))
abalone_train_res %>%
head()
#attaching column of actual observed age
abalone_train_res <- bind_cols(abalone_train_res, abalone_train %>% select(age))
abalone_train_res %>%
head()
#plotting predicted vs. observed
abalone_train_res %>%
ggplot(aes(x=.pred, y=jitter(age))) +
geom_point(alpha = 0.2) +
geom_abline(lty=2) +
theme_classic() +
coord_obs_pred()
summary(lm_wflow)
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
lm_fit %>%
extract_fit_parsnip() %>%
tidy()
#creating recipe using training data
simple_abalone_recipe <- recipe(age ~ sex + length + diameter + ht + whole_wt +
shucked_wt + viscera_wt + shell_wt,
data = abalone_train)
simple_abalone_recipe
#dummy coding categorical predictors
abalone_recipe <- simple_abalone_recipe %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms = ~ sex_M:shucked_wt) %>%
step_interact(terms = ~ length:diameter) %>%
step_interact(terms = ~ shucked_wt:shell_wt) %>%
step_center(all_numeric_predictors()) %>%
step_scale(all_numeric_predictors())
abalone_recipe
#creating and storing linear regression object
lm_model <- linear_reg() %>%
set_engine("lm")
#empty workflow
lm_wflow <- workflow() %>%
add_model(lm_model) %>%
add_recipe(abalone_recipe)
summary(lm_wflow)
#fitting to model and recipe
lm_fit <- fit(lm_wflow, abalone_train)
lm_fit %>%
extract_fit_parsnip() %>%
tidy()
